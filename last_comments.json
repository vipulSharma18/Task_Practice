["Additionally there was a typo strom instead of storm Nothing to do here ", "Hi ericvaandering Please go ahead with the changes The code worked fine for us in our testing there is other changes still to be done though since the link finder is sometimes a bit slow ", "Oops I should know better than that  is not None True bool  False ", "New naming convention ", "Thanks David I could ve sworn we had this working correctly after Mario and Martin helped me with that last year some time but maybe I m just not remembering this correctly But we should get this working properly and automagically at any rate since it will greatly improve our bandwidth since using the internal redirector we basically have  Gbps to work with  storage servers while anything that goes through the proxy is currently limited to its  Gbps through flow Thanks Horst ", "The line was introduced by berghaus on our request because TWAtGH discovered volatile behaviour of protocol stat when it sometimes returned not correct answer Thus we implemented retries we certain schedule but it should not exceed few minutes ", "the  wasn t actually perferred it was already the second attempt First attempt failed because of the capitalize ", "In case file doesn t exist still returns  as exit code while returned data contains just HTML code with  error e g vokac  capath cvmfs atlas cern ch repo ATLASLocalRootBase etc grid security emi certificates cert  USER PROXY X PROPFIND html body  atlas atlasscratchdisk rucio user mphipps   missing file txt Not Found   body html Davix HttpRequest Error HTTP  File not found vokac  echo  Even though stdout is most probably valid XML last line comes from stderr even latest code just fails a bit later with Exception ExpatError because you are trying to access d getetag element that doesn t really exists in a query for non existent file Exception should be clear and is not optimal interface I also think ATLAS capath should not be hardcoded in Rucio sources ", "I read the code again and I don t think this is an issue What happens is that the weighting is skipped if any files in the dataset have replicas on any RSEs in the rule expression which make sense in principle because it means less data movement So I wonder if the bias in the data carousel was because some sites had RAW files lying around and so those sites were preferred even though they had less free space ", "Comment from davidgcameron you have cmd capath   add in the next line something like logger log cmd   can you also make the timeout configurable ", "this was fixed together with issue  ", "Hi Ruturaj no this one is fine The server does also use the rucio config file It just should not be assumed that there is a client section in the server config This is somewhat contradictive ", "Ok I asked around a bit but nobody knows anyone planning to do this I will close the ticket until we can find somebody interested in this development ", "Let s finish the collection of all attributes in  first Then we can organize a rename of the mismatched ones ", "This is partly fixed in cserf PR  but not fully since we should still enable the querying of the global limits with rucio admin as well ", "I think we can just show the ones in DONE and FAILED already But under normal conditions the requests will only be in this state very shortly ", "there currently is no replica attribute that corresponds with the time the replica is physically created i e state AVAILABLE the base class created at attribute stores when the record in the database is created and hence is in particular for a tape stage in scenario not helpful at all best possible workaround is to filter on the updated at attribute instead this could lead to false positives for the motivation use case but these might need to be handled in any case due to a safety overlap in the poll cycle add updated after parameter to all list replicas functions and nested functions down to the place where the SQL query is composed list replicas list replicas list replicas for datasets list replicas for files also to the recursive call for archives add a filter models RSEFileAssociation updated at updated after clause to the replica retrieval queries will need about  lines of code added changed ", "Thanks TWAtGH can you please have a look ", "Indeed I was using the default CentOS  version   After updating to    it works Maybe you can add the requirement for a newer version to the doc as well ", "So specifically changing to  ", "rucio list files actually shows different outputs for an empty and non existing dataset Issue dismissed ", "I think this can be closed ", "This issue was tagged erroneously It is not related to the thread information contained in the messages ", "I decided to use TransferToolWrongAnswer so as not to make a whole new exception for this If you instead prefer a dedicated TransferToolNoID exception let me know ", "The tests also fail in the pull requests but with an Oracle error which I think is unrelated to my changes ", "To me that makes sense but cserf is mostly an advocate of not making these commands too accessibly \ud83d\ude04 But I think you can go ahead and implement that ", "Ok I guess you mean soft delete the RSE Also how do we deal with a new RSE with the same name in the first case Should we reactivate and then update it ", "In the rebalancing script we need to update scopes account strings to InternalScope InternalAccount This should be not too difficult to fix dchristidis can you maybe have a look since TomasJavurek is not available at the moment Thanks ", "hahahannes Can you please have a look in the permission APIs and adapt these lines Wherever issuer in is used Thanks ", "ericvaandering This is great news I confirm that the problem is still present ", "This patch also includes a fix for an error reported by the Undertaker         CRITICAL Traceback most recent call last File usr lib   site packages rucio daemons undertaker undertaker py line  in undertaker delete dids dids chunk account InternalAccount root expire rules True File usr lib   site packages rucio db sqla session py line  in new funct result function args kwargs File usr lib   site packages rucio core did py line  in delete dids rucio core rule archive localgroupdisk datasets scope did scope name did name session session File usr lib   site packages rucio common policy py line  in new funct return function args kwargs File usr lib   site packages rucio db sqla session py line  in new funct result function args kwargs File usr lib   site packages rucio core rule py line  in archive localgroupdisk datasets rucio core did set status scope archive name name open False session session File usr lib   site packages rucio db sqla session py line  in new funct result function args kwargs File usr lib   site packages rucio core did py line  in set status values bytes values length values events resolve bytes length events did scope scope name name session session File usr lib   site packages rucio db sqla session py line  in new funct result function args kwargs File usr lib   site packages rucio core did py line  in resolve bytes length events did did session query models DataIdentifier filter by scope scope name name one File usr    site packages sqlalchemy orm query py line  in one ret self one or none File usr    site packages sqlalchemy orm query py line  in one or none ret list self File usr    site packages sqlalchemy orm query py line  in iter return self execute and instances context File usr    site packages sqlalchemy orm query py line  in execute and instances result conn execute querycontext statement self params File usr    site packages sqlalchemy engine base py line  in execute return meth self multiparams params File usr    site packages sqlalchemy sql elements py line  in execute on connection return connection execute clauseelement self multiparams params File usr    site packages sqlalchemy engine base py line  in execute clauseelement distilled params File usr    site packages sqlalchemy engine base py line  in execute context e util text type statement parameters None None File usr    site packages sqlalchemy engine base py line  in handle dbapi exception util raise from cause sqlalchemy exception exc info File usr    site packages sqlalchemy util compat py line  in raise from cause reraise type exception exception tb exc tb cause cause File usr    site packages sqlalchemy engine base py line  in execute context context constructor dialect self conn args File usr    site packages sqlalchemy engine default py line  in init compiled for key in compiled params File usr    site packages sqlalchemy engine default py line  in genexpr for key in compiled params File usr    site packages sqlalchemy sql type api py line  in process return impl processor process param value dialect File usr lib   site packages rucio db sqla types py line  in process bind param raise InvalidType Cannot insert to db Expected InternalScope got string type ", "Thanks Hannes I had not seen that issue Another interesting finding test did meta py seem to succeed for any RucioException I guess we can discuss this tomorrow in the meeting in conjunction with some generic metadata query times ", "I made some wrong changes on the next branch with the feature PR that removed the dots in some alembic files ", "In principle I think raising a warning is a good idea so that there is at least a trace for this but this might spam the log quite a bit We always considered the caching backends as something optional so we should not spam the users who decide not to run any Make the caching part of rucio cfg so we can track this caching decision See  ", "Hopefully Travis doesn t break this time ", "Demo has been removed ", "this also means forcefully mangling our typical davs into ", "Great Looks like that has progressed to a pull request even so let s close this ", "I think this is just a mistake I think my intention was to ensure that the the directories are not created for RSEs with URL signing enabled in which case the protocol is and self renaming is true So the condition should be not self renaming and dest  instead I will submit a pull request to correct this ", "just passed and ready for merge this fixes the reaper issue ", "current one try it with a non existent file Cheers Rod ", "submitted to probe repo ", "was this the travis issue why it failed I ll restart the pr from illingwo as well an that one would be preferred to approve ", "I tried the rucio update rule stuck id before And now it is shame on me obviously it just took quite long to repair the file miss count But I can confirm that the observed bug from Rucio version   about the wrongly counted files for a certain rule is gone with   ", "This issue will be used only for modifications of rucio core libraries Second issue will be created for the IAM prototype script ", "Hi Lionel Thanks for reporting We will have a look ", "The list is used as an object to which the reference is propagated from pilot to the client I could propagate directly the trace objects from pilot but that wouldn t be generic enought in my opinion I don t see any issues with datasets bulks archives but TWAtGH might be of different opinion ", "You still call new configuration third party read write and I m not completely sure what exactly does this mean For XRootD it is necessary that destination endpoint supports TPC because only pull mode is available but for WebDAV you can either contact destination endpoint and use pull mode or it is also fine if you contact source endpoint and use push mode Currently FTS use for WebDAV pull mode first and than automatically fallback to push it is possible to configure FTS not to try push this makes things even more interesting in case of multisource transfers and I have no idea how FTS currently deals with such TPC transfers in case of push fallback I guess new third party read write configuration doesn t try to cover all possible scenarios push model ", "Looks like they are trying to get the oracle xe docker image back to dockerhub or to give travis access to it I think that might be the only solution ", "After some checks docker compose file etc docker dev docker compose yml up d works for me and root  rucio more opt rucio etc web aliases  conf Rucio REST WSGIScriptAlias accounts opt rucio venv lib   site packages rucio web rest account py points against my env ", "There is more concrete ticket now ", "Just to elaborate on this If it is just something we want to try out let s either do a separate function like Ilija suggested or hide the activation of this somehow We shouldn t pollute the public API with a parameter we use for testing Even if it defaults to something Especially since nobody else can use the VP service anyway Once this is production ready we can decide how to integrate it ", "tbeerman can you please du the etc docker part of the cleanup ", "Seems like they should get created automatically by sqlalchemy as they are the enum types described in the models py Needs to be investigated why they dont get created ", "Hi dciangot We had quite some issues the last days with the  rest api package since it does quite a hacky workaround with including the  package which was killing the building of the entire rucio package This is now temporarily fixed with  but it will for sure come up later thus I would prefer if we can get the  rest api package out of the dependency tree completely Right now it is used in the delegate function inside the transfertool  and also used by some other methods in transfertool  Thus if at all this is only used by CMS since ATLAS also doesn t use this kind of delegation If you have some time on your hand it would be really great to rewrite this functionality so we can remove the dependency Or remove it for now and add it back later if not used Thanks Cheers Martin ", "Originally I wanted to support this as well rucio admin config set section root proxy internal option  value root my proxy host  but I could not figure out even with AllowEncodedSlashes and the quote plus trick to make mod wsgi keep two slashes together So for now we will have to do it like this rucio admin config set section root proxy internal option  value my proxy host  and prepare the root prepend in list replicas ", "I fixed this directly in our dependency file to fix  to   This should also fix the demo issue ", "Hi all For the records the branch I am working in to implement this functionality is here Cheers Gabriele ", "Removed from tools pip requires test It is still pulled in as a sub dependency from Flask though but with    ", " Maybe we should change the  test to check all changed files now instead of only files with the  header ", "Fixed by  ", "TWAtGH this will still need an extension in the downloadclient list replicas replies with in the json case already now and after this patch with xml version   encoding UTF  metalink xmlns urn ietf params xml ns metalink metalink in the metalink case ", "So I have fixed it in my own branch and also re enabled the tests that were set to always pass I could open a pull request for review or do a combined one when I have ready ", "You can drop also pygeoip    GeoIP API ", "Great thanks \ud83d\udc4d ", "It s an optimisation of queries here We don t check if the DID exists we just execute an UPDATE query and check if it affected a row If not the error is raised Which could be replica was already in that state replica is in a state which should not be changed replica does not exist etc It s difficult to give a specific error here without additional queries I am not sure if we should change that since this is also not really a command a simple user is exposed to ", "had to revisit this  support must not be lost ", "Done with my part I also addressed the Protection of sources too strict ", " Can we close this Log verbosity should actually be fine ", "I only tested the NO SOURCES one and this works fine in my finisher But I didn t test the full error yet But yes information is sufficient \ud83d\udc4d ", "I would like to see chacksum after any download no matter on download method But I agree that we don t want to add another query to Rucio DB So only option would be to make it optional and pass the checksum from pilot user etc Pilot should have the src checksum stored in fspec object ", "Problem confirmed in list replicas REST frontend Metalink starts streaming then later the exception is raised causing the client to think everything is in order ", "Yes please go ahead \ud83d\ude09 ", "I would like to be assigned to this issue ", "please look into this pr ", "i have tweaked the dockerfile to remove any isssues during installation ", "Nope one replica is on EISCAT rucio list file replicas          tar SCOPE NAME FILESIZE  RSE REPLICA          tar   GB  EISCAT          tar   GB  NDGF gsiftp preprod srm ndgf org   rucio            tar ", "i would like this to be assigned to me Sorry uploaded a pr before hand ", "Yes I was thinking the same It is too messy in one table also because the global quota is independent from one specific RSE ", "I ll try to tackle this one ", "Issue  was actually fixed by cserf ", "Can be closed as duplicate of  ", "The plan was to change all of these tables with  anyway However I think we should change them explicitly in this separate PR and not intermix them just get s easier to track So for now keep using the history mapper ", "In the current implementation the download priories the root download no explicit extraction if  the file is not in a zip that will be downloaded anyway e g zip is prio  for another file  the file is not in a zip with at least  other files that are needed This decision is made there ", "Seems like MySQL has problems with the original version of core request release waiting requests as well my new query for grouped FIFO LIMIT and IN not supported together This version of MySQL doesn t yet support LIMIT IN ALL ANY SOME subquery It seems like mysql never supported the query for core request release waiting requests UPDATE requests SET state s updated at s WHERE requests id IN SELECT requests id AS requests id nFROM requests nWHERE requests dest rse id s AND requests state s ORDER BY requests requested at ASC n LIMIT s FOR UPDATE this means that the throttler is not working with mysql Updating table while selecting from it You can t specify target table requests for update in FROM clause ", "Please also add a test case for this ", "Thanks illingwo I m currently rewriting all the alembic migrate scripts now properly via and was stumped by this as well ", "The upload client part will be improved with  The rsemgr protocol part will be improved with the rsemgr overhaul So I close this one ", "It might make sense to have both ways if we just want to test a strategy at one conveyor without impacting all of them Thus command line has precedence But I am not really sure if it is needed for the source selection strategy ", "I don t think this can be made generic but I m happy to be proven wrong The symlinking itself is simple enough but for StoRM you ll need the additional webdav etag lookup So something like storm should be perfectly reasonable unless you can find a nice way to make it generic then it would be something like ln ", "Before you go through the effort we should decide if we want to move all the bin scripts to console scripts or everything back to bin Is there any major added benefit of the console scripts We had one issue where a dependency conflict was only affecting the console scripts not the bin scripts So we should get this consistent in one way or the other ", "hahahannes can you please have a look on this In we probably need to join models IdentityAccountAssociation with models Identitiy to add the email there ", "Duplicate of  It s fixed in    ", "This is a duplicate of  it s already merged \ud83d\ude04 ", "Fixed by  ", "Note this seems to affect also other options stored in merged options e g ignore checksum ", "This needs to be fixed in the downstream monitoring Not a bug on our side we are reporting correctly the site ", "Due to session reuse in FTS Not a Rucio bug ", "Yep like rm cp or mv \ud83d\ude04 ", "Duplicate of  ", "Notes pip requires numpy There are some complications with numpy and wsgi this needs to be handled separately in another issue numpy stays at    pip requires client pylint Upgrading pylint to    instead of       is the last version which is   compatible everything else only   and pycodestyles Leaving them at their respective version as a new version generates some errors This will be handled in a separate PR ", "I briefly discussed how to filter RSE protocols used by jobs on specific site and this functionality should go directly in pilot So drop this request ", "download file from archive has been removed rsemanager download is still there needs to be removed later ", "the error coming from  bin rucio admin rse seems to be caused by a change how argparse handles errors in   python import argparse parser argparse ArgumentParser subparsers parser add subparsers first subparser subparsers add parser first help help first second subparser first subparser add subparsers third parser second subparser add parser second help help second third parser add argument version help version args parser parse args print args shell python file py first error too few arguments  file py first Namespace ", "One more seems like the exception handler is borked  is lowercase now but cert does not exist rucio env rjoshi rucio bastion rucio v a rjoshi S  whoami given client cert opt rucio etc web client crt doesn t exist        ERROR Cannot authenticate Details  authentication failed        DEBUG Traceback most recent call last File opt rucio env bin rucio line  in new funct return function args kwargs File opt rucio env bin rucio line  in whoami account client get client args File opt rucio env bin rucio line  in get client elif auth type  proxy UnboundLocalError local variable auth type referenced before assignment        ERROR local variable auth type referenced before assignment        ERROR Rucio exited with an unexpected unknown error Please rerun the last command with the v option to gather more information If it s a problem concerning your experiment or if you re unsure what to do please followup at alastair dewhurst cern ch If you re sure there is a problem with Rucio itself please followup at Completed in   sec ", "After discussion with cserf The blocking of these requests is essentially wanted allow tape is reserved for admins Regular users should not download from tape uncontrolled staging requests to the robots and rather transfer the data to a scratchdisk So everything works as expected Closing ", "Reason was identified as a problematic query which changes the query plan Plan stabilisation needed ", "The check if a rule exists uniqueness is already done The missing part is the uniqueness of list child datasets ", "This adds a new RSE limit parameter MaxSpaceAvailable An alternative would be to use the free attribute of the rse counter entry for the relevant RSE but there d have to be some race free way of setting it ", "Now FTS issue a  when a double submission is done Will modify the conveyor to handle this ", "Not needed ", "Ah ha Looks like an old client has snuck into PYTHONPATH Line numbers above don t match with the current code ", "Adding high priority flag cause this is causing major pain now ", "Hi Andrea no worries The workflow we have is sadly not very simple for somebody new since it is somewhat different than most projects do it so I can understand the confusion Just ping me on Slack if you have any question about the setup \ud83d\ude04 ", "downloadclient can be ignored also because the last  problem is the round function that behaves different in   but we decided to ignore this because of the incompatibility of the fix from builtins import round see  ", "Another proposal was chosen ", "This is a duplicate of  \ud83e\udd23 ", "The new procedure has been implemented ", "I think we should aim to have these functional parts which are potentially useful for a wider audience as daemons We should try to get away from probes for these things ", "Fixed by ", "I will remove the imports and add a basic test to the   client test to check at least imports Also the pylint check for  has to be changed to ignore round errors ", "This should be fixed by  because there I add the new way of changing between all the different modes ", "As discussed in  If there is an API CLI to access history information we should add an index per default If there is no API CLI we still might want to add one if this information is frequently queried by operations ", "This is superseded by  Closing ", "The new reaper relies on the RSE attribute greedyDeletion so I propose to close this ticket ", "I think I d like to get into schema while we wait for  This avoids us having to build our own containers and chase versions It would allow us to just use rucio containers Maybe we can get a CMS person to look into  ", "The original problem was that I set manually the limit on fsize calculated as bytes length This was done only localy at prod  I removed that and rather ordered the query by fsize There is no division by  anymore ", "Ok thanks I missed the SCOPE NAME REGEXP thing I ll go with that then ", "I m not sure if it s mentioned in the documentation but my experimentation shows that the signing operations in the  API work fully offline they still work if I disable the network on my VM but the ones in the old boto API currently used by Rucio don t So it might be necessary to use  if we want offline url signing unless it can somehow be made to work with boto  ", "Yes you are right it s not interacting but exposing primarily for the fts id ", "This is a duplicate of  Closing ", "Fixing this with a PR now more for the other tables in  ", "Actually this has been fixed by  ", "I guess the second sentence should read in the absence of messages in the queue ", "With  the daemon to update the collection replicas has been added It s in    release Thus with this one or the PL SQL procedure it will update the collection replicas to the correct stats ", "It is fine to do it offline but we need to document it somehow I am surprised that this never showed up but in smaller installations the queries will just be quick enough without going against the PK And from a uniqueness point of view this PK is correct as well ", "Per briedel in Slack there s no need to allow single quotes Probably an error illingwo any chance you want to put in a PR ", "Strange for      RFC  ex RFC  DATE FORMAT a d b Y H M S UTC is the format used in dumps loads json cf utils py ", "It s still in the plan but as this is non blocking it doesn t have the highest priority hahahannes Can you please look into the raising a  in case of non supported content type We can discuss this on Monday To also allow application json for certain queries should be not difficult For the n for the last record Just quickly looking into it I couldn t find a definitive answer on this For JSON Which is part of the Line delimited JSON it says The last character in the file may be a line separator and it will be treated the same as if there was no line separator present ", "It seems to me that the right logic here is to pick the most recent entry from rse usage that isn t rucio for each rse and use that to sort the free space The catch is that it isn t very easy to express this in SQL You can do it with a window function like this select rse staging area id from rses left outer join select rse id free from select rse id free row number over partition by rse id order by updated at desc as rownum from rse usage where source rucio as ranked free where rownum  as recent usage on rses id recent usage rse id where deleted false order by free but I don t know how well MySQL supports this and SQLite only added window function support this September ", "but \u00b4rse exists rse name True\u00b4 should give back False instead if the flag is deleted ", "Not a bug This is CERN Megabus force overwriting the Rucio stomp py dependency ", "So the issue here is that the pip dependency resolver is not all that good We need to define stricter dependency ranges for this ", "Related to RSE deletion it might make sense to have a look at  If the RSE is not empty a RSEOperationNotSupported should be raised ", "Also I am not sure how I shall handle the permissions For example I think the permission for set account status should apply for changes on all account properties Then I would also update the permission files ", "This also links to  ", "We can check again but I think the registration is working fine now ", "Depends on  ", "Shall I also add ASN availability and usage as there are also missing ", "New repository The probes will be migrated ", "It gets downloaded correctly using the current master and  It s also done correctly in case the whole zip is downloaded ", "Okay linking the ticket for the connection bug ", "Not only filemeta is returned wrong but also the identity tags venv   twegner twegner dev rucio rucio list file replicas metalink expression NIKHEF ELPROD DATADISK   DRAW RPVLL   pool root  metalink xmlns urn ietf params xml ns metalink file name DRAW RPVLL   zip  identity   DRAW RPVLL   zip  identity file metalink venv   twegner twegner dev rucio rucio list file replicas metalink   DRAW RPVLL   pool root  metalink xmlns urn ietf params xml ns metalink file name DRAW RPVLL   pool root  identity   DRAW RPVLL   pool root  identity file metalink I d prefer that the identity tag always contains the constituent DID ", "Priority increased ", " has been implemented and merged Therefore all downloads with eventType get sm or get sm a shouldn t report any suspicious files ", "Need to check with TomasJavurek and TWAtGH ", "Ahh sorry \ud83d\ude04 Thanks a lot ", "Discussed in Dev Meeting on We should do it like planned ", "Fixed now on kubernetes side ", "Hmm it might be a bit confusing as one could assume that no archives means there are not archive replicas in the result Although to some extend no resolve archives could be interpreted the same ", "Duplicate ", "Yes it s a quite heavy change touching all systems That s why I think it would have to be a new TEMPORARYUNAVAILABLE state so it is obvious to other daemons that this is not a normal UNAVAILABLE replica ", "That should be fine I think how JSON is implemented in sqlalchemy is that if the database does not support it it just creates a blob or big varchar thus we can switch to this even before  is available you just can t use the json functionality I think it should be fine to have this in the next feature release ", "Solved by  ", "Reminder For ATLAS we need to remove the puppet monkey patch were we update usr lib   site packages  contrib pyopenssl py ", "Yes I m currently working on the downloadclient anyway ", "Ok I will close this one as a Duplicate of  then ", "I see I think it is a bit too clustered to do this based on directories It might be better if we add a tag such as  COMPATIBLE in the header of the file below the authors for example and the test essentially only tests if these tagged files stayed compatible We just have to be consistent in the future to keep tagging the newly compatible files ", "Ok Closing with reference to  ", "We should check if there is a common implementation to do this ", "We have hole somewhere in rsemgr upload method What is certainly wrong that we don t have same structure on return once list and once dictionary The case of upload to CERN PROD ES leads to the empty list ret so it returns gs True but this should actually never happen ", "This was fixed automatically through  ", "Ok cool I ll take care of the  part then later on Thanks ", "Duplicate of  ", "We should be able to remove pycrypto It s a secondary dependency and  will automatically fallback to pyOpenSSL which we have anyway ", "I would suggest to close this one As I ve written above adding these classes to the main client is not necessary and could be quite problematic ", "Confirmed \u2705 related to pkg ressources in the pip version I think we can change the to a that should be sufficient to fix this since we do not need that strict comparison anyway ", "I think I ve found them all rucio core account counter py also uses  on a uuid but the concat function coerces its arguments to text anyway so that one should be okay ", "Proposing to close as duplicate of  ", "Change for list replicas Return multiple fields in metalink parent did parent Return single list field in json parents   Convention is not to resolve all parents only the ones the user is requesting ", "What was the reason for changing this to ALL again I remember that it was on COLLECTION in the beginning ", "rucio download metalink my replicas  scope name ", "Decided against Spikes memory and network on server node Will provide palnilsson a function to generate metalink pilot side from the list replica reply ", "suggestion allow tape ", "So this probably needs to wait until pycurl is an extra in the  rest api package For now although only the requirements readthedocs txt should be used it seems like rucio as a package is pulled in as well which then requires pycurl via  rest api crashing readthedocs build Needs a version    ", "ok confirmed the bug this is not properly taking into account that there are two root doors one internal one external and thus takes the higher priority one of the internal door thus jumping in front of srm when it should just ignore it and instead take the priority of the external door which is left out completely at actual priority  since there already is a bad root priority assigned ", "Would be solved by ", "No  will fix this ", "Although it can be that certain activities can be processed only by certain accounts and travis had not the rights to run this activity ", "Good call thanks I ve fixed it with  There were also another bug ", "It should be set per replica It s a valid case to have a file which has normal replicas but is also a constituent of an archive Thus some replicas of this file would have client extract True some would not ", "ok figured it out zipped replicas which are not part of the rse expression are not correctly removed in the response to the client ", "The order of this configuration was changed some time in the past So what s currently in the demo rucio cfg is wrong Changing the config as file as you proposed will fix it No need to fix the config reader ", "The associated RSE for resolved archives is not correctly updated it sets the RSE of the existing replica instead ", "Just the previous versoin which is from  but it s not on PyPI anymore This is starting to get tricky ", "Can we increase the priority of this ticket It s mainly for AMI ", "Maybe it would be useful to implement the possibility to filter more generally For example size gt to filter out containers with a size greater than  And of course size lt for less than shell rucio list dids user bla filter size gt  type CONTAINER ", "This is more of a deployment issue since from a code point of view a distributed memcached can be used Moving this to ATLAS jira ", "mlassnig nikmagini TomasJavurek can one of you take over this ticket It would actually be nice if we can get this into    on Monday If nobody has time I can take it as well ", "Actually  can stay open but I would close this one and leave  ", "yes my idea was to mount this via secrets e g apiVersion  kind Secret type Opaque data gridpw host cert privkey pem metadata name atlas auth namespace default ", "Pinging hahahannes ", "This is not a bug but a missing feature Rucio download does respect the order but it s not able to determine if lan or wan should be used Instead it always uses the default wan ", "Oh I thought it is already  line per account but I just tried it and saw that it is multiple lines We will fix that and make it one line per account Will be fixed in  ", "Any update ", "TWAtGH FYI ", "I m currently still having troubles getting Oracle  reliably running on travis i e you will need to add a switch in the code to enable and disable this feature based on the version of Oracle So if the version is  then disable json support otherwise enable it This will be necessary anyway since our production DB is still  and we also would run tests both against  and  ", "Duplicate of  Closing ", "berghaus You recently did some changes in this code I think Can you maybe have a look on this issue \ud83d\ude03 ", "Can we confirm that this works correctly with the pilot The test version of rucio on the ALRB is    so this should be possible ", "Hi olifre No let s use this ticket tbeerman can you please update the template Cheers ", "Yes Thanks a lot TomasJavurek ", "Identified when raising DuplicateRule the error is not passed to the exception ", "I tried to reproduce this but can t Closing ", "The code for bin rucio TWAtGH will add ", "The usual release cycle is  weeks However we did not deploy    due to a problem thus we are still on       will be deployed tomorrow ", "Yes that s it Closing the ticket ", "Andrea Manzi commented that it looks like a gfal issue with xrootd cancel Anyway for the other protocols it seems to work for now I ve submitted a pull request to implement it note currently it won t do anything due to a bug in propagation of transfer timeout in the client submitting a separate bug report ", "This is on hold until a new version of  is released which supports pycodestyle    Only support for    at the moment ", "I am not sure if we really need to add this in the days of containers The argument for sqlite was always that it is easy as you do not need to install mysql etc for quick development But now in the days of containers the point is not really valid anymore If the code runs fine on mysql postgres oracle it is fine I think ", "yes  ", "This should probably be fixed by doing a MERGE INSERT into the history table That should solve the issue It s not high priority though \ud83d\ude04 Thanks for the report ", "Cool thanks ", "it s easier to do it for the daemons first as there are no tests using the clis cf ", "tests ", "For the first one RequestNotFound should be raised instead of generic RucioException in transfer py and the exception should be caught in common py The second one should catch JSONDecodeError ", "not for me on  pip doesn t find the last version and that s why I relaxed the version requirement ", "I used docker ps and found that other application was using the port  Stopping that app and restarting docker service resolved the issue I did not try the option given by tbeerman but I think that would work too Thank you all ", "Closing this It s basically  ", "This is a problem on the current master Once solved a rebase will solve the errors on your PR as well ", "All right I found similar link error in other places created PR for this ", "mlassnig Done Sorry for the mix up before ", "Thanks Martin I ll get started with it ", "The last ones missing are the didclient fileclient  and the downloadclient According to pylint there are just small changes needed I can fix them ", " Should be indeed datetime timedelta hours   Should be tomorrow datetime utcnow timedelta  ", "This has been implemented in  ", "this should go also in alembic and schema ", "Ok never mind I added upstream remote with same URL as origin which is the URL of my fork and that error is gone now ", "Ok it seems in certain versions of postgres only a date instead of a datatime is returned when querying the db With a date object this check becomes quite useless I will disable it in case a date is returned ", "Wont t be done cause the grafana information does not provide what we want ", "Files to re add venv garvin rucio garvin cat doc source api upload rst Upload Methods upload automodule rucio client uploadclient members undoc members show inheritance venv garvin rucio garvin cat doc source api download rst Download Methods download automodule rucio client downloadclient members undoc members show inheritance just adding them in the repo generates errors warning when doing python setup py build sphinx ", "What endpoint name should we use in this case Maybe configuration is a bit confusing as there already is an endpoint config Also I would like to reopen the PR to use the export distances function ", "The test error should be unrelated as we have some instabilities in the test with dbs I ve relaunched the failed tests manually in travis Thanks for the PR ", "The part describing the installation is nice a really good work guys I ve extended and rst formated the README in  plus adding it in the main index of the documentation with a new Tutorial demo section For me the remaining part is to extend doc source rucio demo rst with more examples from rucio ping to how to configure rucio rse accounts etc and then how to use rucio find files upload download etc Merge and integrate some examples from cli admin examples rst and cli examples rst ", "This will also fix these issues     ", "This will also fix this issue    ", "Actually this is not done yet but got intermixed with the replica lan wan issue Reopening and moving to    ", "High ranking is actually ok as the probe sets it inversely to the agis distance There are some inaccuracies and minor mistakes there which will be followed up in a different ticket ", "Done ", "This will happen with the coming rse manager overhaul ", "This is sufficiently covered by  No additional development necessary ", "Fixed by   Someday I ll get the GitHub linkage correct ", "Note this is fixed in next but not in master So I think this becomes a backport exercise ", "Hi bbockelm how do I now define an RSE so that it would not pass the spacetoken to FTS Adding srm protocol still requires a non empty spacetoken argument rucio admin rse add protocol hostname  pi infn it scheme srm prefix cms store test rucio web service path srm  SFN port  impl rucio rse protocols  Default domain json wan read  write  delete  third party copy  space token  IT Pisa Error space token and web service path must be provided for SRM endpoints ", "Fixed ", "Alright I think this one is good to go ", "As discussed today this should probably be coordinated with TomasJavurek as he is already working on the download function ", "Submitted with two more fixes hopefully all are caught now On      AM Mario Lassnig wrote The convention is that minus should be used in CLI arguments instead of underscore Anything else is a typo mistake \u2014 You are receiving this because you were mentioned Reply to this email directly view it on GitHub or mute the thread ", "That all sounds sensible I ll work on making my current code into a dual stack version The pull request for this already contains some documentation about building the policy packages ", "I didn t have a look on it On next it is solved ", "This is a duplicate of  ", "Closed this comes implicitly with Reaper   ", "hahahannes this one might also be good for you We can discuss the details one of these days ", " I think this issue can be closed We have   and  for the next steps ", "Not needed anymore ", "Hi sartiran I am closing this now If the problem shows up again please open another ticket \ud83d\ude04 ", "most likely due to no protocols registered at the destination RSE ", "The core change will be intercepted by the web rest layer and eventually the client It could be properly handled there and make the client not except out into userspace ", "I also started replacing return FAILURE statements with exceptions My plan is now to finish the upload part of  so that Tomas can push it in his repo I will also put in the failover during this and a couple of bugfixes and cleanups ", "Thanks for the thorough investigation ", "This looks like a regression from the latest WAN LAN domain support patch We actually have a domain called third party copy which we would like to use in the future because it might be different than WAN data access priority but it s not used yet ", "Actually that s a different problem than  Reopening ", "I compare with three servers I setup in asgc and use wireshark to check ssl process But still fail to get a conclusion i will prepare what I have tested later Now I just use one of the server that is working and put the problemic one aside    Martin Barisits notifications github com \u5beb\u9053\uff1a Was there any conclusion on this \u2014 You are receiving this because you were mentioned Reply to this email directly view it on GitHub or mute the thread ", "third party copy has been added to the schema in December  This should be fine now ", "Another option which should keep backward compatibility with the clients with special lookahead in regexp we can extract the delimiter from the regexp Example re match meta user bbockelm foo bar baz meta groups user bbockelm foo bar baz one possibility then is to make certain regexp policy configurable ", "Gotcha will close for now ", "Yes the error should be raised on server side though ", "bin rucio replica recoverer Contains in an epilog variable my current procedure for manual testing Once I learn more about rucio should I write a test for this daemon lib rucio core replica py Although there are some differences the two functions get suspicious files and the new get available suspicious replicas seem to be aiming for similar outputs Could we merge the two into one ", "It is more flexible but some errors might be generated client side and then you would have to contact the server to know the addresses Overall not a big issue I think as the config has to be distributed anyway I am closing this let s follow up in  ", "Re closing this issue as I can create these datasets on the CMS instance with the client patches in  applied ", "This has been done ", "vingar I will do Thanks ", "\ud83c\udf88 \ud83c\udf7e ", "duplicate with ", "yes I realized it when creating a new repo ", "Yes I ll close the other one ", "There is really no need to self reference the issue number in the issue itself \ud83d\ude04 ", "Yes it is Closing \ud83d\ude04 ", "Fixed by  ", "Yes The method path is always core api rest network client So to make the rest api you will have to implement the api as well But all these are very simple and analogous The api is basically the layer in between where permissions etc are checked in the core itself everything works without permissions I think a good stack to look at are the identities Each account has different identities such as username pass  certs etc So the API file is The REST interface is You will also have to add the new apache endpoint to and so that apache mod wsgi can find it ", "Fixed by  ", "yes we should replace the current rucio container with rucio dev ", "One option is to drop support for Python   it s not received any security updates for four years and is little used Here s the pip installs for rucio from PyPI for the last month via pypinfo percent pip rucio pyversion python version percent download count                ", "The solution is not streightforeward since we don t have dump of lock table in hadoop ", "closed ", "I suggest raising the priority on this ", "There are some changes planned for this in regards to local moving protocols storm ", "it s there but hidden in the code formatting rucio v add dataset user briedel test test test lifetime  ", "Yes A lot of these errors could be VO specific so it is not bad to have the first line VO support filter before it goes to the Rucio github And secondly some errors might include partially confidential information where we might not want to encourage posting them on a public issue tracker ", "This is a duplicate now of  Closing this ticket as we use the other one to track the changes ", "Yes it s implemented but I used the wrong issue number on the PR so it s not linked here But the issue can be closed ", "Will be replaced by json import from CRIC  ", "Proposal for consistency trace user trace event type ", "There is two things For the errors testing everything is fine because there really should not be any error in the code Testing for score though you should do file by file If you get a score for everything the few files changed in the PR will not really move the general score although the files themselves might have a very bad one ", "Weird I don t know what I did then Can be closed I guess ", "try the symbolic link then ", "alembic is fixed by another patch thanks Martin ", "Going to work on  first to set up my dev environment if you guys like the suggestions that is ", "Duplicate  ", "Right now DataidentifierNotFound is raised in these cases and I think we can keep it the same This is really only for the case where a dataset is not deleted yet but logically it already should be ", "It should point to ", "hahahannes the ticket text is a bit misleading The idea of the ticket is a rucio admin command which can put a tombstone on a specific replica which has no locks etc We can discuss details in person ", "already implemented ", "Closing as duplicate ", "Ahhh sorry I thought it was  didn t recover from my jet lag fro Gex p SUSPENDED would be the right thing to do ", "Right now also schemes compatible to the source schemes are used which at the moment works out fine but this should not be done as it could result in conflicts ", "You mean about the epic issue link above I accidentally linked  first but then corrected to  Maybe in your eMail it still says the first version ", "A dataset is INCOMPLETE if there is at least one LOST or DELETED file in the dataset The fact that this file is not in the main table only in the deleted one anymore is fine in my opinion Don t get me wrong I fully understand what you mean that conceptually the DELETED LOST file should be kept in the table dataset but from this workflow we walked away a long time ago We do remove lost deleted files in the table dataset and move it to the deleted one ", "Linking  as it is relvant here too ", "Fix in an earlier patch ", "Should be dropped ", "i will extend it to list replicas domain wan once the signature for create protocol is merged then we can gradually start making the clients domain aware ", "Multiproces in Python  ", "this is starting to affect sites with different LAN WAN protocol settings ", "If a child rule is expired and replicating it cannot be removed as the FK constraint of the parent rule is active In this case the child rule id is removed from the parent rule and the parent rule is set to infinite lifetime ", "x Poller x Submitter x Receiver Finisher ", "Duplicate of  ", "If no sources are available maybe rule should inform user that this is permanent terminal ", "Not needed Too dangerous ", "I could find a page under the link account rse usage which has no links directing to it yet Also it shows a search field Should it be removed so that automatically the user account gets choosen or is this page relevant for admins ", "Discussed in the dev meeting on Add new column CLOB Column should only be used if the normal column is NULL ", "this one is fixed ", "I summarized issues we have with extracting the files here ", "I ran pip extra reqs Here is the list returned anyjson in requirements txt argcomplete in requirements txt argparse in requirements txt babel in requirements txt cffi in requirements txt coverage in requirements txt cryptography in requirements txt docutils in requirements txt  in requirements txt flup in requirements txt  in requirements txt futures in requirements txt gcloud in requirements txt gearman in requirements txt git review in requirements txt googleapis common protos in requirements txt grpcio in requirements txt in requirements txt idna in requirements txt ipaddress in requirements txt  in requirements txt mako in requirements txt maxminddb in requirements txt  in requirements txt ntplib in requirements txt numpy in requirements txt  in requirements txt ordereddict in requirements txt paste in requirements txt pinocchio in requirements txt protobuf in requirements txt  in requirements txt  modules in requirements txt pycparser in requirements txt pycrypto in requirements txt pygments in requirements txt pyopenssl in requirements txt pytest xdist in requirements txt python editor in requirements txt python memcached in requirements txt python swiftclient in requirements txt repoze lru in requirements txt rsa in requirements txt setuptools in requirements txt six in requirements txt tox in requirements txt Some modules like argparse and argcomplete appear in this list because they are already in   by default ", "OK Additional point I can make the client resolve automatically if the user has passed LFN vs PFN But please let me know if you prefer instead that the user should specify this explicitly through an option ", "Done by  ", "Starting today I will be marking each time DDM Ops is affected by this issue fire ", "Duplicate of  ", "There seems to be a limit of  dids when registering files to dataset One option would be to have the client split into chunks of  ", "I see thanks \ud83d\udc4d Closing ", "Checking the code the gfal protocol already has a hardcoded  s timeout ", "For this it should be fine as deleting an RSE is a really rare thing to do "]